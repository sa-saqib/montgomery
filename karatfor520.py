from add2hex import add2hex
from karatfor512 import karatfor512
from karatfor8 import karatfor8
from sub2hex import sub2hex

def karatfor520(k,l): 
    if len(k) <= 65:
        k= k + ((65-len(k))*['00'])
    if len(l) <= 65:
        l= l + ((65-len(k))*['00']  )   

    result520 = []  
        
    lowk = k[:64]   
    lowl = l[:64]   
    r520low = karatfor512(lowk, lowl) 
    result520+=(r520low[:64])                                                                                                        
    
    highk =  k[64:]   
    highl =  l[64:]

    r520high = karatfor8(highk, highl)
    
    
    x=add2hex(lowk,highk)  
    y=add2hex(lowl,highl)
    

    if ((len(x)) & (len(y)) == 65) : 
        x, y = x[:64], y[:64]                                                          
        
        midpat = karatfor512(x,y)                                       
        
       
        midpart = karatfor512( (add2hex(x, ['01'])), (add2hex(y, ['01'])) ) 
        
        midm = sub2hex((sub2hex(midpart, midpat)),['01'])  
        
        midh = add2hex( midm, midpat[64:])  
        
        mid = []
        mid = add2hex((midpat[:64] + midh),(128*['00']+['01']) )  
        # mid = midpat +  midm + ['01'] 


    elif (len(x) ==64) & (len(y) == 65) :
        if x==['00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00',
               '00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00'] :
            mid =['00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00',
               '00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00',
               '00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00',
               '00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00']
        else:
            y = y[:64]  
            midpat = karatfor512(x,y)
                
            midpart = karatfor512( (add2hex(y, ['01'])), (x))  
            

            midm =sub2hex((sub2hex(midpart, midpat)),['01']) 
            

            midh = add2hex( midm, midpart[64:])  
            
            mid = []
            mid = (midpat[:64] + midh) 
               

    elif (len(y) ==64) & (len(x) == 65) :
        if y['00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00',
               '00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00'] :
            mid =['00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00',
               '00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00',
               '00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00',
               '00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00','00']
        else:
            x = x[:64]  
            midpat = karatfor512(x,y)
               
            midpart = karatfor512( (add2hex(x, ['01'])), (y))  
           

            midm =sub2hex((sub2hex(midpart, midpat)),['01']) 
            

            midh = add2hex( midm, midpart[64:])  
           
            mid = []
            mid = (midpat[:64] + midh) 
            
       
    else:
        mid = karatfor512(x,y)  
                                                            
    mid0= (sub2hex(mid,(r520low))) 
     
    
    mid0=   (sub2hex(mid0,(r520high))  )
                          
    mid1 = add2hex(mid0,r520low[64:])                                         
       
    result520 +=(mid1[:64])
    result520 +=(add2hex(mid1[64:],r520high)) 
     

    return result520[:130]


zi= ['ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff']
yes=['ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff','ff']

print(karatfor520(zi,yes))